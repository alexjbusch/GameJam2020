pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- game loop

function _init()
	player0=player_new(0)
	player0.max_spd=0.75
	player0.spr=1
	toggle_cls=true
end


function _update()
	player_update(player0)
	if btnp(🅾️) then toggle_cls=(not toggle_cls) end
end


function _draw()
	if toggle_cls then cls() end
	player_draw(player0)

	rectfill(0,105,127,127,1)
	print("x: ",1,106,10) print(player0.x,12,106,7)
	print("y: ",1,114,10) print(player0.y,12,114,7)
	print("🅾️: ",1,122,10) print("toggle cls",16,122,7)
	print("spd:  ",72,106,10) print(player0.spd,96,106,7)
	print("spdx: ",72,114,10) print(player0.spdx,96,114,7)
	print("spdy: ",72,122,10) print(player0.spdy,96,122,7)
end

-->8
-- objects

-- actor
function actor_new()
	local actor={
		x=63,
		y=63,
		dx=0,
		dy=0,
		spd=0,
		spd_max=0,
		dir=0,
		dir_last=0,
		spr=0,
	}
	return actor
end

function actor_update(actor)
	actor.spd=actor.dir and actor.max_spd or 0
	actor.spdx=actor.spd*cos(actor.dir)
	actor.spdy=actor.spd*sin(actor.dir)
	if actor.dir~=actor.dir_last then
		actor.x=round(actor.x)
		actor.y=round(actor.y)
	end
	if actor.spd>0 then
		actor.x+=actor.spdx
		actor.y+=actor.spdy
	end
	actor.dir_last=actor.dir
end
	
function actor_draw(actor)
	spr(actor.spr,round(actor.x),round(actor.y))
end

-- player
function player_new(player_index)
	local player=actor_new()
	player.index=player_index
	return player
end

function player_update(player)
	player.dir=get_direction(player.index)
	actor_update(player)
end

player_draw=actor_draw

function get_direction(player_index)
	local p=player_index
	local dirs={nil,0.5,0,nil,0.25,0.375,0.125,nil,0.75,0.625,0.875,nil,nil,nil,nil,nil}
	local dec=0
	for i,b in ipairs({btn(⬅️,p),btn(➡️,p),btn(⬆️,p),btn(⬇️,p)}) do
		dec+=b and (2^(i-1)) or 0
	end
	return dirs[dec+1]
end

-->8
-- misc

function round(n)
	return (n%1<0.5) and flr(n) or ceil(n)
end

__gfx__
00000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000a00000000000000000000000000a0000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000a0000000000000000000000000000a000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000a000000000000000000000000000000a00000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000a00000000000000000000000000000000a0000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000a0000000000000000000000000000000000a000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000a000000000000000000000000000000000000a00000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000a00000000000000000000000000000000000000a0000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000000000000000000000000000a000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000a00000000000000000000000000000000000000000a00000000000000000000000000000000000000000
00000000000000000000000000000000000000000000a000000000000000000000000000000000000000000a0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000a000000000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a00000000000000000000aaaaaa00000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000000a000000a0000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a000000000000000000a00000000a000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a00000000000000000a0000000000a00000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a000000000000a0000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000a0000000000000000a0000000000000a000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000a00000000000000a0000000000000a0000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000a000000000000a0000000000000a00000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000000a0000000000a0000000000000a000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000000a00000000a0000000000000a0000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000aaaaaaaa0000000000000a00000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000a000000000000000000000000000000000
0000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaa00000000000000000000000000000a000000000000000000000000000000000
000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000a000000000000000000000000000000000
00000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000a0000000000000000000000000000000000
0000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000a00000000000000000000000000000000000
000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000a000000000000000000000000000000000000
000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000a0000000000000000000000000000000000000
000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000a00000000000000000000000000000000000000
000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000a000000000000000000000000000000000000000
000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000a0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000a00000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000a00000000000000000000000000000000000000a000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000a000000000000000000000000000000000000a0000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000a0000000000000000000000000000000000a00000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000a00000000000000000000000000000000a000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000a000000000000000000000000000000a0000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000a0000000000000000000000000000a00000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1a1a111111117771717111111111111111111111111111111111111111111111111111111aa1aaa1aa1111111111111177711111111111111111111111111111
1a1a11a11111717171711111111111111111111111111111111111111111111111111111a111a1a1a1a11a111111111171711111111111111111111111111111
11a111111111777177711111111111111111111111111111111111111111111111111111aaa1aaa1a1a111111111111171711111111111111111111111111111
1a1a11a1111111711171111111111111111111111111111111111111111111111111111111a1a111a1a11a111111111171711111111111111111111111111111
1a1a11111111117111711111111111111111111111111111111111111111111111111111aa11a111aaa111111111111177711111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1a1a111111117771777111111111111111111111111111111111111111111111111111111aa1aaa1aa11a1a11111111177711111111111111111111111111111
1a1a11a11111117171111111111111111111111111111111111111111111111111111111a111a1a1a1a1a1a11a11111171711111111111111111111111111111
1aaa11111111777177711111111111111111111111111111111111111111111111111111aaa1aaa1a1a11a111111111171711111111111111111111111111111
111a11a1111171111171111111111111111111111111111111111111111111111111111111a1a111a1a1a1a11a11111171711111111111111111111111111111
1aaa11111111777177711111111111111111111111111111111111111111111111111111aa11a111aaa1a1a11111111177711111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11aaaaa111111111777117711771177171117771111117717111177111111111111111111aa1aaa1aa11a1a11111111177711111111111111111111111111111
1aa111aa11a1111117117171711171117111711111117111711171111111111111111111a111a1a1a1a1a1a11a11111171711111111111111111111111111111
1aa1a1aa1111111117117171711171117111771111117111711177711111111111111111aaa1aaa1a1a1aaa11111111171711111111111111111111111111111
1aa111aa11a111111711717171717171711171111111711171111171111111111111111111a1a111a1a111a11a11111171711111111111111111111111111111
11aaaaa11111111117117711777177717771777111111771777177111111111111111111aa11a111aaa1aaa11111111177711111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111

